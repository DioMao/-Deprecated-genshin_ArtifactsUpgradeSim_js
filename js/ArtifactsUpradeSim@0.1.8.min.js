"use strict";function versionCheck(){let t=window.localStorage,e=t[ArtifactsSim.localStorageKey];if(!t)throw new Error("The browser does not support LocalStorage.");if(null==t.ArtifactsSimVersion)return t.ArtifactsSimVersion=ArtifactsSim.version,!0;if(t.ArtifactsSimVersion!=ArtifactsSim.version)return alert("模拟器版本更新，如果遇到错误，请尝试清除浏览器缓存!"),t.ArtifactsSimVersion=ArtifactsSim.version,!1;if(null!=e&&"[]"!=e&&""!=e)try{ArtifactsSim.AUSList=JSON.parse(e)}catch(t){console.log("%cSet new Artifacts list fail.","color:rgb(144,82,41)")}return!0}class ArtifactConst{constructor(){const t=[7,14.9,22.8,30.8,38.7,46.6],e=[8.7,18.6,28.6,38.5,48.4,58.3];this.__ArtifactConstList__={entryList:["critRate","critDMG","ATK","ATKPer","def","defPer","HP","HPPer","energyRecharge","elementMastery"],entryListCh:["暴击率","暴击伤害","攻击力","攻击力","防御力","防御力","生命值","生命值","元素充能效率","元素精通"],entryProbability:[.3,.3,.75,.5,.75,.5,.75,.5,.3,.3],entryValue:{critRate:[2.7222,3.1111,3.5,3.8889],critDMG:[5.4402,6.2174,7,7.7718],ATK:[13.6111,15.5556,17.5,19.4444],ATKPer:[4.0833,4.6667,5.25,5.8333],def:[16.3333,18.5,21,23.3333],defPer:[5.1031,5.8321,6.5611,7.2901],HP:[209.125,239,268.875,298.75],HPPer:[4.0833,4.6667,5.25,5.8333],energyRecharge:[4.5325,5.18,5.8275,6.475],elementMastery:[16.3333,18.5,21,23.3333]},extraEnrtyRate:.3,parts:["feather","flower","hourglass","hat","cup"],partsCh:["死之羽","生之花","时之沙","理之冠","空之杯"],feather:["ATK"],flower:["HP"],hourglass:["ATKPer","defPer","HPPer","elementMastery","energyRecharge"],hat:["critRate","critDMG","ATKPer","defPer","HPPer","elementMastery","HPRes"],cup:["ATKPer","defPer","HPPer","elementMastery","water","fire","thunder","rock","wind","ice","Physical"],mainEntryList:["ATK","HP","critRate","energyRecharge","HPRes","critDMG","ATKPer","defPer","HPPer","elementMastery","water","fire","thunder","rock","wind","ice","Physical"],mainEntryListCh:["攻击力","生命值","暴击率","元素充能效率","治疗加成","暴击伤害","攻击力","防御力","生命值","元素精通","水元素伤害加成","火元素伤害加成","雷元素伤害加成","岩元素伤害加成","风元素伤害加成","冰元素伤害加成","物理伤害加成"],hourglassRate:[.26,.26,.26,.1,.1],hatRate:[.1,.1,.22,.22,.22,.04,.1],cupRate:[.21,.21,.21,.025,.05,.05,.05,.05,.05,.05,.05],mainEntryValueList:{ATK:[47,100,152,205,258,311],HP:[717,1530,2342,3156,3967,4780],critRate:[4.7,9.9,15.2,20.5,25.8,31.1],energyRecharge:[7.8,16.5,25.4,34.2,43,51.8],HPRes:[5.4,11.5,17.6,23.7,29.8,35.9],critDMG:[9.3,19.9,30.5,41,51.6,62.2],ATKPer:t,defPer:e,HPPer:t,elementMastery:[28,60,91,123,155,187],water:t,fire:t,thunder:t,rock:t,wind:t,ice:t,Physical:e},scoreList:["atk","crit","def","hp","er","em"],scoreListCh:["攻击得分","双暴得分","防御得分","生命得分","充能得分","精通得分"],scoreStandar:{critRate:2,critDMG:1,ATK:.13,ATKPer:1.345,def:.11,defPer:1.07,HP:.0087,HPPer:1.345,energyRecharge:1.2,elementMastery:.339}};const r=()=>{throw new Error("Error!This data is read only!")},i=t=>new Proxy(t,{set:r,defineProperty:r,deleteProperty:r,preventExtensions:r,setPrototypeOf:r});this.__ArtifactConstList__=i(this.__ArtifactConstList__)}get val(){return this.__ArtifactConstList__}}class ArtifactsFunction_class{constructor(){this.__version__="0.1.8",this.__AUSList__=[],this.history=[],this.deleteHistory=[],this.suitList=[],this.__maxResults__=1e3,this.localStorageKey="AUSLocalList"}creatArtifact(t="",e="",r=[],i=[]){if(this.__AUSList__.length>=this.__maxResults__)return console.log(`Warning - The maximum length of the artifacts list is ${this.__maxResults__}.`),!1;let n={level:0,part:"none",mainEntry:"none",mainEntryValue:0,entry:[],initEntry:"",upgradeHistory:[],creationDate:Date.now()},a=[],s=[];"string"==typeof t&&-1!=artiConst.val.parts.indexOf(t)?n.part=t:n.part=artiConst.val.parts[Math.floor(Math.random()*artiConst.val.parts.length)],"string"==typeof e&&-1!=artiConst.val.mainEntryList.indexOf(e)&&this.mainEntryVerify(n.part,e)?n.mainEntry=e:n.mainEntry=this.randomMainEntry(n.part),n.mainEntryValue=artiConst.val.mainEntryValueList[n.mainEntry][0];for(let t=0;t<artiConst.val.entryList.length;t++)artiConst.val.entryList[t]!=n.mainEntry&&(a.push(artiConst.val.entryList[t]),s.push(artiConst.val.entryProbability[t]));if(r.length<=4&&this.entryVerify(n.mainEntry,r))for(let t=0;t<r.length;t++){let e=r[t],o=i[t],l=a.indexOf(e);a.splice(l,1),s.splice(l,1),0!=i.length&&"number"==typeof o&&-1!=artiConst.val.entryValue[e].indexOf(o)||(o=this.randomEntryValue(r)),n.entry.push([e,o])}for(;n.entry.length<3;){let t=this.randomRate(a,s),e=this.randomEntryValue(t),r=a.indexOf(t);a.splice(r,1),s.splice(r,1),n.entry.push([t,e])}if(0==r.length&&Math.random()<artiConst.val.extraEnrtyRate){let t=this.randomRate(a,s);n.entry[3]=[t,this.randomEntryValue(t)]}return n.initEntry=JSON.stringify(n.entry),this.__AUSList__.push(n),this.setLocalStorage(this.localStorageKey,this.__AUSList__),n}upgrade(t,e="",r=-1){if(t>=this.__AUSList__.length||t<0)return!1;let i=this.__AUSList__[t],n=[],a=[],s=[];if(i.level>=20)return!1;if(i.entry.length<4){for(let t=0;t<i.entry.length;t++)n.push(i.entry[t][0]);for(let t=0;t<artiConst.val.entryList.length;t++)n.indexOf(artiConst.val.entryList[t])<0&&(a.push(artiConst.val.entryList[t]),s.push(artiConst.val.entryProbability[t]));let t=this.randomRate(a,s),e=this.randomEntryValue(t);i.entry.push([t,e]),i.upgradeHistory.push([t,e])}else{let t=0,n="",a=0;if(""!=e&&artiConst.val.entryList.indexOf(e)>=0)for(let r=0;r<i.entry.length;r++)e==i.entry[r][0]&&(t=r,n=i.entry[r][0]);else t=Math.floor(Math.random()*i.entry.length),n=i.entry[t][0];a=-1!=r&&"number"==typeof r&&Math.floor(r)<artiConst.val.entryValue[n].length?artiConst.val.entryValue[n][Math.floor(r)]:this.randomEntryValue(n),i.entry[t][1]+=a,i.upgradeHistory.push([n,a])}return i.level+=4,i.mainEntryValue=artiConst.val.mainEntryValueList[i.mainEntry][i.level/4],this.setLocalStorage(this.localStorageKey,this.__AUSList__),!0}ArtifactScore(t,e="default"){if("number"!=typeof t||"string"!=typeof e&&!Array.isArray(e))return 0;if(t>=this.__AUSList__.length||t<0)return 0;let r=0,i=0,n=0,a=0,s=0,o=0,l=0,h=this.__AUSList__[t].entry;for(let t=0;t<h.length;t++){let e=h[t][0],l=h[t][1]*artiConst.val.scoreStandar[e];"ATK"==e||"ATKPer"==e?r+=l:"critRate"==e||"critDMG"==e?i+=l:"def"==e||"defPer"==e?n+=l:"HP"==e||"HPPer"==e?a+=l:"energyRecharge"==e?s+=l:"elementMastery"==e&&(o+=l)}if(Array.isArray(e))for(let t=0;t<e.length;t++)switch(e[t].toLowerCase()){case"atk":l+=r;break;case"crit":l+=i;break;case"def":l+=n;break;case"hp":l+=a;break;case"er":l+=s;break;case"em":l+=o;break;default:l+=0}else switch(e=e.toLowerCase(),e){case"default":return r+i;case"atk":return r;case"crit":return i;case"def":return n;case"hp":return a;case"er":return s;case"em":return o}return l}reset(t){let e=this.__AUSList__[t];e.entry.length=0,e.entry=JSON.parse(e.initEntry),e.upgradeHistory.length=0,e.level=0,e.mainEntryValue=artiConst.val.mainEntryValueList[e.mainEntry][0],this.setLocalStorage(this.localStorageKey,this.__AUSList__)}resetAll(){for(let t=0;t<this.__AUSList__.length;t++)this.reset(t);this.setLocalStorage(this.localStorageKey,this.__AUSList__)}deleteOne(t){this.deleteHistory.push(this.__AUSList__.splice(t,1)[0]),this.setLocalStorage(this.localStorageKey,this.__AUSList__)}batchDelete(t){t.sort((t,e)=>t-e);for(let e=t.length-1;e>=0;e--)this.deleteHistory.push(this.__AUSList__.splice(t[e],1)[0])}clearAll(){this.__AUSList__.length=0,this.setLocalStorage(this.localStorageKey,this.__AUSList__)}undoDel(){return 0==this.deleteHistory.length?(console.log("Undo false, history not found."),!1):(this.__AUSList__.push(this.deleteHistory.pop()),this.setLocalStorage(this.localStorageKey,this.__AUSList__),!0)}newSuit(){}toChinese(t,e){return"string"==typeof t&&"string"==typeof e&&("entry"==e?-1!=artiConst.val.entryList.indexOf(t)&&artiConst.val.entryListCh[artiConst.val.entryList.indexOf(t)]:"parts"==e?-1!=artiConst.val.parts.indexOf(t)&&artiConst.val.partsCh[artiConst.val.parts.indexOf(t)]:"mainEntry"==e?-1!=artiConst.val.mainEntryList.indexOf(t)&&artiConst.val.mainEntryListCh[artiConst.val.mainEntryList.indexOf(t)]:"score"==e&&(-1!=artiConst.val.scoreList.indexOf(t)&&artiConst.val.scoreListCh[artiConst.val.scoreList.indexOf(t)]))}entryValFormat(t,e,r="default"){const i=["critRate","critDMG","ATKPer","defPer","HPPer","energyRecharge"],n=["ATK","HP","elementMastery"];return"string"==typeof t&&"string"==typeof r&&("string"==typeof e||"number"==typeof e)&&("main"==r.toLowerCase()?-1!=artiConst.val.mainEntryList.indexOf(t)&&(e=-1!=n.indexOf(t)?this.toThousands(e):Number.parseFloat(e).toFixed(1)+"%",e):-1!=artiConst.val.entryList.indexOf(t)&&(e=-1!=i.indexOf(t)?Number.parseFloat(e).toFixed(1)+"%":this.toThousands(Number.parseFloat(e).toFixed(0)),e))}randomRate(t,e){if(!Array.isArray(t)||!Array.isArray(e))throw new Error("Function RandomRate Warning!Wrong parameter.");if(t.length!=e.length)throw new Error("Function RandomRate Warning!Array length different!");let r=Math.random(),i=0,n=0;for(let t=0;t<e.length;t++)n+=e[t];r*=n;for(let n=0;n<e.length;n++)if(i+=e[n],r<=i)return t[n];return t[t.length-1]}randomMainEntry(t){if("string"!=typeof t)throw new Error("Function randomMainEntry Error!Wrong parameter(Not string).");switch(t){case"feather":return"ATK";case"flower":return"HP";case"hourglass":return this.randomRate(artiConst.val.hourglass,artiConst.val.hourglassRate);case"hat":return this.randomRate(artiConst.val.hat,artiConst.val.hatRate);case"cup":return this.randomRate(artiConst.val.cup,artiConst.val.cupRate);default:return console.log("Error! -randomMainEntry-"),!1}}randomEntryValue(t){if("string"!=typeof t)throw new Error("Function randomEntryValue Error!Wrong parameter(Not string).");return artiConst.val.entryValue[t][Math.floor(Math.random()*artiConst.val.entryValue[t].length)]}mainEntryVerify(t,e){if("string"!=typeof t||"string"!=typeof e)throw new Error("Function mainEntryVerify Error!Wrong parameter(Not string).");return-1!=artiConst.val.parts.indexOf(t)&&-1!=artiConst.val.mainEntryList.indexOf(e)&&-1!=artiConst.val[t].indexOf(e)}entryVerify(t,e){if("string"!=typeof t||!Array.isArray(e))throw new Error("Function entryVerify Error!Wrong parameter.");for(let r=0;r<e.length;r++)if(t==e[r]||-1==artiConst.val.entryList.indexOf(e[r]))return!1;return!0}toThousands(t){return(t||0).toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")}get MihoyoImYourDaddy(){for(let t=0;t<this.AUSList.length;t++){const e=this.AUSList[t];for(let r=0;r<e.entry.length;r++){const i=e.entry[r];if("critRate"==i[0]||"critDMG"==i[0])for(;e.level<20;)this.upgrade(t,i[0],3)}}return"Yes,you are!"}setLocalStorage(t,e){"object"==typeof e&&(e=JSON.stringify(e)),"number"==typeof e&&(e=e.toString());let r=window.localStorage;if(!r)throw new Error("The browser does not support LocalStorage.");r.setItem(t,e)}get version(){return this.__version__}get AUSList(){return this.__AUSList__}set AUSList(t){Array.isArray(t)&&(t.length>this.__maxResults__&&(t.length=this.__maxResults__,console.log(`Warning - The maximum length of the artifacts list is ${this.__maxResults__}.`)),this.__AUSList__.length=0,this.__AUSList__=t,this.setLocalStorage(this.localStorageKey,this.__AUSList__),console.log("%cSet new Artifacts list success.","color:rgb(144,82,41)"))}}const artiConst=new ArtifactConst,ArtifactsSim=new ArtifactsFunction_class;console.log("%cArtifactsUpgradeSim is running.Learn more: https://github.com/DioMao/genshin_ArtifactsUpgradeSim_js","color:rgb(144,82,41)"),versionCheck();